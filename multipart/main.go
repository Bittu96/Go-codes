package main

import (
	"bytes"
	"encoding/json"
	"fmt"
	"io/ioutil"
	"log"
	"mime/multipart"
	"net/http"
	"strings"
)

type chMilvusOut struct {
	XcallID        string        `json:"xcallid"`
	TopFiveResults []DistRecord  `json:"top_five_results"`
	MatchResults   []MatchRecord `json:"match_results"`
	MatchCount     int32         `json:"match_count"`
}

type DistRecord struct {
	XcallID  string  `json:"xcallid"`
	Distance float64 `json:"distance"`
}

type MatchRecord struct {
	ID       string  `json:"id"`
	Distance float64 `json:"distance"`
}

func makeMultipartRequestMilvus(endpoint, encodings, partition_name, XcallID string) (*http.Request, error) {
	body := new(bytes.Buffer)

	writer := multipart.NewWriter(body)
	if err := writer.WriteField("encodings", encodings); err != nil {
		errMsg := "unable to write encodings"
		log.Println("Msg: " + errMsg + " Error: " + err.Error() + " XcallID: " + XcallID)
		return nil, err
	}

	if err := writer.WriteField("partition_name", partition_name); err != nil {
		errMsg := "unable to write partition_name"
		log.Println("Msg: " + errMsg + " Error: " + err.Error() + " XcallID: " + XcallID)
		return nil, err
	}

	if err := writer.WriteField("XcallID", XcallID); err != nil {
		errMsg := "unable to write XcallID"
		log.Println("Msg: " + errMsg + " Error: " + err.Error() + " XcallID: " + XcallID)
		return nil, err
	}

	if err := writer.Close(); err != nil {
		return nil, err
	}

	req, err := http.NewRequest("POST", endpoint, body)
	if err != nil {
		errMsg := "unable to create request"
		log.Println("Msg: " + errMsg + " Error: " + err.Error() + " XcallID: " + XcallID)
	}
	req.Header.Add("Content-Type", writer.FormDataContentType())
	return req, nil
}

func CheckMilvusEncodings() (chMilvusOut, error) {
	var req *http.Request
	var err error

	encodings := "[0.12261495739221573,0.479570597410202,0.3101242482662201,0.26139408349990845,0.05718491971492767,0,0.4000236690044403,1.5317190885543823,0.10196556150913239,0.030811963602900505,0.009816556237637997,0.7001144886016846,0.18101143836975098,0.19528281688690186,0.01317258644849062,0,0.19161629676818848,0,0.02520427480340004,0.4410770535469055,0.010831463150680065,0.10133597254753113,0.37160131335258484,0.016981463879346848,0.7283205986022949,0.29247403144836426,0.13878779113292694,0.38608255982398987,0.4599379599094391,0.01063232496380806,0,0,0.1445656269788742,1.4413573741912842,2.4105582237243652,0.07181613147258759,0.17919468879699707,0.0035182165447622538,0.978485643863678,0.2414626032114029,0.03813384845852852,0.15732866525650024,1.123579740524292,0.003432461293414235,0.09117434173822403,1.8616893291473389,0.07598554342985153,0.12897881865501404,0.04424210637807846,0.6608057618141174,0.18958605825901031,0.5062776803970337,2.684654712677002,0.486288845539093,0,0.6019459366798401,0.5338626503944397,2.3981082439422607,1.386483073234558,0.13509047031402588,0.2827976644039154,0.06081385537981987,1.303194284439087,0.02850925736129284,0.9651366472244263,0.46518033742904663,0.009602152742445469,0.9057952165603638,1.627629041671753,0,0.007851715199649334,0.4502769112586975,0.30175644159317017,0.008552341721951962,0.11308272927999496,0.006753247696906328,0.017110338434576988,0.014001002535223961,0.026588790118694305,0.009893597103655338,1.9563766717910767,1.2997088432312012,0.11749378591775894,0,0.5320773124694824,0.19368557631969452,1.1805548667907715,0.004123281687498093,0.13809677958488464,0.09755013138055801,0.5070562362670898,0.7959827780723572,0,0.5331054329872131,1.6401516199111938,0.6041527986526489,0,1.4832251071929932,0.07860694825649261,0.30711424350738525,0.08183030039072037,0.10844150185585022,0.16682757437229156,0.3517991304397583,0.7668041586875916,0.9846348762512207,0.7761911749839783,0.7314397096633911,0.015007792972028255,0.00012031623191433027,1.2394334077835083,1.1682881116867065,0.00864423904567957,0,0.12977302074432373,0.4574156403541565,0.3935864567756653,0.5916131138801575,0.526002824306488,0.1427231878042221,0.0023976077791303396,0.01886335387825966,0.20301221311092377,2.526123285293579,0.5182650685310364,0.06289724260568619,0.0032934679184108973,0.18543200194835663,0.004965005908161402,0.22960884869098663,0.005003094673156738,0.6809567809104919,0.0038276156410574913,0.14766152203083038,0.15868927538394928,0.04060402512550354,0.13748586177825928,0.9494977593421936,0.03852164000272751,0,2.8658652305603027,0,3.9418184757232666,2.231196165084839,0.005512909032404423,0.8803343772888184,0,0.3524017333984375,0.04668121784925461,0.09520378708839417,0.7777858376502991,1.3171570301055908,0.3486340641975403,0.20701593160629272,0.2837897539138794,3.511031150817871,0.017215991392731667,0.05894909054040909,0.39628469944000244,0.20342311263084412,0,0.05867955461144447,2.274203300476074,0.007584092672914267,1.4380608797073364,1.4800952672958374,0.3166065514087677,0.05121397599577904,0.04689731076359749,0.6288993954658508,0,0.921629011631012,1.9052163362503052,0.019424710422754288,0.4075155556201935,0.8592338562011719,1.0824077129364014,1.688637375831604,0,0.4446295201778412,0.0017188568599522114,0.06819018721580505,2.756117820739746,0.21357490122318268,0.14432449638843536,0.34160497784614563,0.23112905025482178,0.031537652015686035,0.0008160520810633898,0.525837242603302,0,0,0.6369204521179199,0.004633823409676552,0,2.240617036819458,0.02336837537586689,0.003414782928302884,0,0.0008353408775292337,0.0692623034119606,0.05644205957651138,0.014823169447481632,0.12506474554538727,0.43697938323020935,0.32845622301101685,0.5409334301948547,0.05861862376332283,1.053200602531433,0.0248736459761858,0.018696175888180733,0.06140043959021568,0.21455490589141846,0.22193413972854614,0.023842498660087585,0.6692008376121521,0.44253578782081604,0.468695729970932,0.5589233636856079,1.1135395765304565,0.010911696590483189,0.12145470827817917,0.4595843255519867,0.037282031029462814,0.08254048973321915,0.2606118321418762,0.03339161351323128,0.1356145739555359,1.2985169887542725,0.7038583755493164,1.6157654523849487,0.07880181819200516,0.6158975958824158,0.0021606830414384604,0.013636216521263123,0.007807804737240076,0,0,1.3221709728240967,0.08007749170064926,0.06556297093629837,1.8908694982528687,0,1.0949269533157349,0.7885859608650208,0.05174820125102997,0.6040530800819397,0.12438447773456573,0.2809608280658722,1.379302978515625,0,0.06870594620704651,1.0623910427093506,0,0.17522838711738586,0,0.9808949828147888,0.3210410177707672,0,0.6613128185272217,0.6518959403038025,1.4415676593780518,0.05076006054878235,0.28288188576698303,0,0.012818129733204842,2.2514266967773438,1.739863395690918,1.0339878797531128,0.27965760231018066,0.0999869778752327,0.005695666652172804,0.7635798454284668,0.6638755798339844,0.045145921409130096,0,0.0009451009682379663,0.38343581557273865,0.29462000727653503,0.02217569388449192,0,1.0853272676467896,0.022998899221420288,0.1342737227678299,0.5988650321960449,0.07628433406352997,1.6103510856628418,0.04335075616836548,0.7588254809379578,0.7383067011833191,0.0599365234375,0.7326468825340271,0,0,0.22162573039531708,0,0.012765093706548214,0.028241140767931938,0.01721176505088806,0.5224617719650269,0.6337365508079529,0.7164322733879089,0.46067553758621216,0,0,0.12196209281682968,0.025664163753390312,1.464883804321289,0.25466182827949524,3.1530325412750244,0.015482522547245026,0.1134103536605835,3.4631335735321045,0.1436627060174942,0.3226845860481262,0.05185079574584961,1.9842898845672607,0.6155823469161987,0.44579586386680603,0.05909353494644165,0.015870453789830208,1.8095948696136475,1.8638789653778076,0.06567429006099701,2.7210488319396973,0,0.4242391288280487,0.15003038942813873,0.3998485207557678,0.14663192629814148,0.2951131761074066,0.45149052143096924,2.0632662773132324,1.9532395601272583,0.4120420217514038,0.01307323295623064,0,0,0.32680681347846985,0.14878115057945251,0.28330716490745544,2.862739324569702,0,0.00565031822770834,0.0011993038933724165,1.1504738330841064,0.0034002624452114105,0.024894315749406815,0.382320374250412,1.427135705947876,0.00916132889688015,0.011960701085627079,0,0.14607998728752136,0.019217276945710182,0.05212013050913811,2.7678608894348145,0.13585582375526428,0.12922711670398712,0.6725022196769714,0.0454157218337059,0,0.008705966174602509,1.1438895463943481,1.7688405513763428,3.142465353012085,1.2346341609954834,1.6801966428756714,0.04033161327242851,0.02579893171787262,0.2936742305755615,0.20923595130443573,0.0853806734085083,1.4880985021591187,0.4731961488723755,0.4783646762371063,2.1031808853149414,0.14879317581653595,0,0.09089905023574829,0.049663081765174866,0.2861151099205017,0.5182707905769348,0.012617412954568863,1.2899852991104126,0.4997956156730652,0.03368205577135086,0.09675269573926926,0.015023786574602127,2.5699329376220703,0.0022259317338466644,0.01205346081405878,0,1.4110482931137085,0.021258840337395668,0.0037925145588815212,0.06880979239940643,0.835074782371521,0.13388828933238983,0.9887881875038147,0.11220867931842804,0.38507184386253357,0.19915032386779785,0.13421966135501862,0.13473141193389893,0,0.6219800710678101,0.184006005525589,0.04144354164600372,0.08919684588909149,0.0008608382777310908,0.07610258460044861,0.5690941214561462,0.3195912539958954,0,0.010650984942913055,1.335801362991333,0.007000913377851248,0,0.4222775399684906,0.8479446172714233,0.5029224753379822,0.2927980422973633,0.27068525552749634,0.0019159171497449279,0.052587687969207764,0,0,0.02921947091817856,0,0.11440883576869965,0.07631765305995941,0.05224017798900604,0.20647494494915009,0.5847185254096985,0.03722507879137993,0.0034947784151881933,0.5212736129760742,0.39973559975624084,0.20547543466091156,0,0.5012742877006531,0,0,0.09088066965341568,0,0.17771343886852264,0.29100659489631653,0.03928711265325546,0.3463164269924164,0,0.4561775326728821,0.599292516708374,0.0032433003652840853,0.09906774014234543,0,2.584524393081665,0.051135458052158356,0,0.08328602463006973,0.2581554651260376,0.16636745631694794,1.845241665840149,0.13120350241661072,0.04944681003689766,0.3800482451915741,0.3802030086517334,0.8214783668518066,0.012724606320261955,0,0,0.6395612359046936,1.2807084321975708,0,0.09335668385028839,0.5516647696495056,0,0.6783581376075745,0.0025526685640215874,0.38212957978248596,0.1391535848379135,0.06817445904016495,0.3233443796634674,0.26434624195098877,0.016073696315288544,0.5389243364334106,1.4736303091049194,1.7216206789016724,0.20201453566551208,0,0.23503850400447845,0.8200625777244568,0.7261261343955994,0.009847231209278107,0.003478653496131301,0,0,0.004521121736615896,0,0.3124840259552002,0.001457798294723034,2.7297651767730713,0.06025267019867897,0.0033749269787222147,0.07423724234104156,0.015303827822208405,0,0.024382608011364937,0.028311720117926598,0.0007640828844159842,0.4442162811756134,0.6978689432144165,0.8832110166549683,0,0.7557686567306519,0.31661108136177063,0.026300135999917984,1.6460936069488525,1.203600287437439,0.012613741680979729,0.010999718680977821,0.016057385131716728,0,0.007871543057262897,0,1.2310558557510376,2.1809751987457275,0.07886165380477905,0.9190331101417542,0.20663969218730927,0,0.13503949344158173,0.011098789051175117,0.41933533549308777,1.3360157012939453,1.6223267316818237,0.028078272938728333,0.0036851386539638042,0.42103320360183716,2.644730806350708,0.18006236851215363,1.0292367935180664,0,1.0216848850250244,0,0.09899801015853882,1.906447172164917,0,1.526612401008606,2.996953248977661,2.1885929107666016,1.4619394540786743,0,0.19745884835720062,0.04365501552820206,0,2.0765633583068848,0,0.06746692955493927,0,0.004252579528838396,0,0.02870863303542137,2.8150970935821533,0.839809238910675,0.013526988215744495,0.4953465461730957,0.2695082724094391,0.06876762211322784,0.08978663384914398,0.10600986331701279,0.5499072670936584,0.16585224866867065,1.3472408056259155,0.005436863284558058,0.005991252139210701,0,0.21108068525791168,0.08001426607370377,1.191104531288147,2.1373589038848877,0.17558233439922333,1.910952091217041,1.0471959114074707,0.6856756210327148,0.1571718454360962,0.07590354233980179,0.19158077239990234,0,0.016140053048729897,0.13215623795986176,0.00020215462427586317,0,1.391168236732483,0.26278185844421387,2.91560435295105,0.43693506717681885,0.0002854746126104146,0.058050427585840225,0.6663280129432678,0.01940252259373665,0.23411373794078827,0,0.5806370377540588,0.007102606352418661,0.13404136896133423,0.2501538395881653,0.1173616349697113,1.2221719026565552,0.030600139871239662,2.1571946144104004,0.1160104051232338,0.2524509131908417,0.20945343375205994,0.18303509056568146,0,0.003237809520214796,0.16265834867954254,0,0.0009702516836114228,0.012048624455928802,0.88067227602005,0.979820966720581,1.3036751747131348,0.06976195424795151,0.624832272529602,0.015943391248583794,0.16284170746803284,0.0019360063597559929,0.15187929570674896,2.5378801822662354,0.0554882176220417,0.9386098980903625,0.00925866886973381,0.06830158084630966,0.014811046421527863,0.25080570578575134,0.22591380774974823,0.04038599878549576,0.304076224565506,0,0.002640709513798356,0.3666691780090332,2.7126922607421875,0,0.08143512904644012,0.07270627468824387,0.007482190616428852,0.059313297271728516,0.007929276674985886,1.476078748703003,2.262401819229126,0.3407761752605438,0,1.216797947883606,0.01606595702469349,0.06092491000890732,0.2275838702917099,1.2823164463043213,0.02828281745314598,0.583412230014801,0.004567474592477083,0.023596029728651047,0.08586032688617706,0.02287028357386589,0,0,0.0009833379881456494,0,0.024470653384923935,1.955014705657959,0.08498931676149368,1.7614201307296753,0,0.018734987825155258,0.07064817100763321,0.09538404643535614,0.0033730706200003624,0,1.346835970878601,1.1142566204071045,0.5998761057853699,0.05172305181622505,0.07591450214385986,0.005917656235396862,1.3279613256454468,0.007662228308618069,0.1615876853466034,1.8145147562026978,0.11617251485586166,0.5238377451896667,0.9523953199386597,0.013231921941041946,0.2715950310230255,0.0888652577996254,0,1.378077507019043,0,0.2570453882217407,0.06054602935910225,0,0.013265347108244896,0.22803270816802979,0.04889887571334839,0.5651537179946899,1.0637127161026,1.8334380388259888,0.05608321353793144,0.01467086561024189,0.15530486404895782,0.02214876003563404,0.007547164335846901,1.7488821744918823,0.2119055539369583,0.009024040773510933,0.031185775995254517,0.5867171883583069,0.00007207661110442132,0.3313833773136139,2.16270112991333,0.951373279094696,0.46916964650154114,0.07523730397224426,1.2304996252059937,0.4513678252696991,0.22384639084339142,0,0.2362937480211258,0.19676519930362701,0.22162702679634094,0,0.07397032529115677,0,0.42926597595214844,0.7675017714500427,1.0647765398025513,0.17710690200328827,1.140267252922058,0.8545679450035095,0.3472152650356293,0.0029212285298854113,0.016921108588576317,0,0.03922627866268158,0,0.017486143857240677,0,1.0195497274398804,2.3130311965942383,0,0.16442367434501648,1.0816746950149536,0.01380451861768961,0.017068201676011086,0.30942514538764954,0.09336903691291809,0.308285117149353,1.172458291053772,0.002719390206038952,1.5167171955108643,0.6187771558761597,0.2282223403453827,0.21185894310474396,0,0.5800374746322632,0.36007437109947205,0.32628586888313293,0.5038463473320007,0.5605964660644531,0.6533632874488831,0.14607080817222595,1.0318025350570679,0.010690322145819664,0,0.016454828903079033,0,1.1333142518997192,0.2810969352722168,0.06365371495485306,0.3049173355102539,0.16897882521152496,0.3409518301486969,1.4311048984527588,1.659926176071167,0.7492132186889648,0.23361653089523315,0,0.23295842111110687,0.29867011308670044,0.7145553827285767,0.04191652685403824,0.49403876066207886,0,0.02871119976043701,0.3840411305427551,0.8867508769035339,0,0.6691396832466125,0.7744570970535278,1.6485567092895508,0.2005191147327423,0.8247531056404114,0.3903115391731262,0.21715763211250305,0.34535107016563416,0.6534575819969177,0,0.015775252133607864,0,0.07209988683462143,0.13998596370220184,0,1.1577403545379639,0.02467353455722332,2.8646059036254883,0.09922406822443008,0.5756359100341797,0.33272796869277954,0.0904264971613884,0.38471516966819763,0.11437014490365982,0,0.8484838604927063,0,0.1275823563337326,0.21774865686893463,0.00027047371258959174,0,0.16496218740940094,0.46790772676467896,0.9587619304656982,0.5202950239181519,1.0093680620193481,0.01351183746010065,0.30830785632133484,0.3130934536457062,0.49838629364967346,0.5305292010307312,0.5600818395614624,0.5694384574890137,0.7313283681869507,2.440424919128418,0.6888371706008911,0.0074229128658771515,0.5340781807899475,0.0299069881439209,0.18320269882678986,0.6542189717292786,0,0.002922843908891082,0.08353647589683533,1.6481550931930542,0.6683075428009033,0.00003408169141039252,0.07718120515346527,1.8676949739456177,0,2.179114580154419,0,0,1.6594278812408447,1.137465000152588,0.04120786860585213,1.3886066675186157,0.05566850304603577,0.14643318951129913,0.004240853246301413,0.0006175016751512885,0.08803710341453552,0,0.0034448662772774696,2.2852542400360107,1.6949940919876099,0.00357254920527339,0,0.14633707702159882,0,0.3572741150856018,0,0.025363674387335777,0.18767161667346954,0.017439648509025574,0.07106304913759232,0.0464661568403244,0.006852130405604839,1.072587251663208,0.12789343297481537,1.0886541604995728,0.00924835354089737,0.24640393257141113,0.0051010847091674805,0.5241551399230957,0.04690953344106674,2.7392117977142334,1.4001264572143555,1.2270089387893677,0,0.1409161537885666,0,0.001925838179886341,0.4568823277950287,0.062383830547332764,0.08106706291437149,0,0.02325315773487091,1.653281569480896,0.9259608387947083,0,0.682106077671051,0,2.2662525177001953,1.5941535234451294,0.6589798331260681,0.0077562942169606686,0.3814329504966736,0.8069241642951965,0.05549374222755432,0.5281466841697693,0.0968141257762909,0,0,0.006242718081921339,2.649223804473877,0.013018039986491203,0.6256972551345825,0.40633127093315125,0.2225751280784607,0.10797388851642609,0.016346270218491554,0.3630315363407135,0.8567838072776794,0.6138055920600891,2.7727365493774414,0,0.03679259121417999,0,1.2816425561904907,0.20706914365291595,0.0623885840177536,2.3133771419525146,0,0,0.39255088567733765,0.0035016622859984636,0.4680708944797516,0.01649077981710434,0.08642762899398804,1.328132152557373,0.1801087111234665,1.8644843101501465,0.11810687184333801,0.14765191078186035,0.4154760539531708,3.5124030113220215,0.02852095104753971,0.012709257192909718,0.3626309633255005,2.6630916595458984,0.03215814754366875,1.2860649824142456,1.2801960706710815,0,0.04633806273341179,0.5481173396110535,0.011549662798643112,0,0.016238480806350708,0.6862225532531738,0.25345832109451294,0.43966397643089294,0.6065767407417297,0.7353995442390442,1.165603518486023,0.04817131534218788,0.08300044387578964,0.1829204559326172,0.4073738157749176,0.42240142822265625,0.4354708790779114,0.025147603824734688,0.19373883306980133,2.1489129066467285,0.014231477864086628,0.14598694443702698,0.03515162318944931,1.4335591793060303,0.11719737946987152,0,0,0.16620230674743652,0.5726622939109802,0.11434414237737656,1.5948013067245483,0.3019416630268097,1.0044224262237549,0.3388661742210388,0.3827076256275177,0.1623714566230774,0.37691807746887207,0,3.5644593238830566,0.5529968738555908,0.40399447083473206,2.439072847366333,0.2762002646923065,0.30846232175827026,0.22591355443000793,0,1.324498176574707,0.2513555586338043,0.0008732274873182178,0.08821485191583633,0.28395876288414,0.8058685064315796,0.09319674968719482,0.0040163020603358746,0.07920129597187042,1.3991684913635254,2.34557843208313,0.08137951791286469,0.22088764607906342,0.02383066713809967,1.7972098588943481,0.009047171100974083,0.2754858732223511,0,0.8100217580795288,0.061497464776039124,1.7808573246002197,0.02024747245013714,0.33951783180236816,0.008859657682478428,0.016726067289710045,0.23888467252254486,0.02785372920334339,0.22412167489528656,0.0558418445289135,0,0.551429033279419,0.6546345949172974,0.7842209339141846,0.04847804829478264,0.03543819114565849,0.8477962017059326,0.03237086534500122,0.13295862078666687,1.3780086040496826,0,1.2569435834884644,0.012398740276694298,0.16543477773666382,0.4089846611022949,0.13258947432041168,0,0,0.008889099583029747,0.05537080764770508,0.01775352843105793,0.10330282151699066,0.01720506139099598,0.10504335165023804,1.1536072492599487,0.18177218735218048,0.0817219465970993,0.13961058855056763,0.24266940355300903,0.2359773814678192,1.886749267578125,0.42168620228767395,2.4464731216430664,2.1351895332336426,0.5557933449745178,0.04769982025027275,1.8409147262573242,0.15143895149230957,1.2219865322113037,0.00920055340975523,0.08734556287527084,0.4849039912223816,0.0007842633058317006,0,1.1529393196105957,0.2286500334739685,0.000630091642960906,0.015301808714866638,0.012859592214226723,0.027069903910160065,0.10779742896556854,0.02575625479221344,0,0.17981810867786407,0.0496411994099617,0.5140487551689148,0.3297496438026428,0.03185456618666649,0.2639031410217285,0.14916881918907166,0.07062084227800369,0.9834478497505188,0.3125101625919342,0,1.531292200088501,0,0.3388414978981018,3.7995808124542236,0.00225573661737144,0.8147741556167603,0.03818954527378082,0.0844210684299469,0.36414697766304016,0,0,0,1.2258708477020264,0,0,1.1796631813049316,0,0,0.0726236030459404,0.2544771432876587,0.0010528709972277284,0.3171224296092987,0.27138105034828186,0.8889790177345276,0.3916224539279938,2.7407143115997314,0.027874350547790527,0.000037855032132938504,0.29511556029319763,0.26736223697662354,1.0096367597579956,0.22712260484695435,0.01738356612622738,0.42841100692749023,0.5363928079605103,3.6296346187591553,0.08827286213636398,0.1109059751033783,0.39794301986694336,2.7920379638671875,0.001511172391474247,0.06280678510665894,0.0782722756266594,2.9044783115386963,0.7808038592338562,0.015140272676944733,0,0.03319314122200012,0.17905952036380768,0,0.008123218081891537,0.12783004343509674,0.03916269913315773,0.05224106088280678,1.3271311521530151,0.6276453733444214,0.0013771445956081152,0.026574943214654922,0.049529679119586945,0,0.07338035851716995,0,0.4786339998245239,0.30873656272888184,0.0482868067920208,1.6330742835998535,0.36910632252693176,0,0.01313313189893961,0,0,0.6668235659599304,0.5763037800788879,0,0.7240086197853088,0.11954466998577118,0.10742998868227005,1.68055260181427,1.5346695184707642,0.16344843804836273,0.06520186364650726,0,0,0,0.28526949882507324,0.170267254114151,1.3996522426605225,0.030797988176345825,0.001985737355425954,0.8520886301994324,0,0.0026577564422041178,2.2367970943450928,0.0771896168589592,0,2.8594770431518555,0.09815151989459991,0.6565216779708862,0.07695623487234116,0.7973865866661072,0.0021362474653869867,0.2553631663322449,1.3554071187973022,0.3348008692264557,0,0,0.5816922187805176,0.28108498454093933,0.7558693289756775,0.5429192781448364,0.02356182038784027,0.014577874913811684,0,0.07376184314489365,0.4830763638019562,0.015479122288525105,0.7434717416763306,0.06018475443124771,0.4556165933609009,0.39934805035591125,0.02887469343841076,0.18451154232025146,0,1.0635114908218384,1.395803689956665,1.004773736000061,0.03422406315803528,0,0.0956868901848793,0,1.0338612794876099,0.16814252734184265,1.4441874027252197,0.11275628954172134,0.5300124287605286,0.8560201525688171,0,0.30337005853652954,0.10132674872875214,0.012080954387784004,0.09606097638607025,0.7718529105186462,0.9316896200180054,0,0,0.3690946102142334,0.0027761217206716537,0.056088998913764954,0,0.3113073706626892,0.00804706010967493,0.025878725573420525,1.020101547241211,0.12286072224378586,0,0.027625558897852898,0.0249182041734457,0.037414561957120895,0.0037483463529497385,0.54062819480896,0,0.5712594985961914,0.16840216517448425,1.6049411296844482,0.036983877420425415,0.059224918484687805,0.03877577930688858,1.124772548675537,0.06120333820581436,1.4068009853363037,0.13960178196430206,0.409382164478302,1.9127353429794312,1.3482393026351929,1.0579347610473633,0.1275917887687683,0.2843344211578369,0.696158766746521,0.3216772973537445,1.5683995485305786,0.9439996480941772,0.015024677850306034,0.4931066036224365,1.236148715019226,0,0.2471373975276947,2.238051652908325,0.04722094163298607,0.10553586483001709,0.11238275468349457,1.5085923671722412,1.734641432762146,0.02495395392179489,0.03516527637839317,1.8724300861358643,0.025826234370470047,0.00557361077517271,1.1318376064300537,0.7583351135253906,0.5206103920936584,0.11364208161830902,0,0.5686179399490356,0.13905003666877747,0.9331942796707153,0.027740105986595154,0.2066558599472046,0,0.013865643180906773,0.04737159237265587,0,0.46140849590301514,0.6069588661193848,0,0.1469155102968216,0.3129115104675293,0.7140083909034729,0.0018335799686610699,0.5595508217811584,0.44108784198760986,0.0019138345960527658,0.5086151957511902,0.19158311188220978,0.040926601737737656,0.2790621221065521,0.07474502921104431,0.08395866304636002,0.11562152951955795,0.05579213798046112,0.27830225229263306,1.5861252546310425,1.2679888010025024,0,0.04878724366426468,0,0.06726887077093124,1.3320809602737427,0.0020800805650651455,1.1139576435089111,0,0,0.11634272336959839,0.07200317829847336,0.17340025305747986,0.9426978826522827,0,0.0041715833358466625,0.043725915253162384,0.3122400939464569,0.648278534412384,0.03480101749300957,0.041930362582206726,0,0.005268921609967947,0.16984978318214417,0.7321392893791199,1.2290700674057007,1.172829270362854,0,0.13312123715877533,1.8662084341049194,0.23169249296188354,0.06567535549402237,0.5025365948677063,0.07069490104913712,0,0.010629789903759956,0.014993168413639069,1.6340570449829102,0.8713386058807373,0.7267143726348877,0.04814548045396805,0.6160740256309509,0.17987973988056183,0.03572547063231468,0.014777657575905323,0.5758137702941895,0,0.36864322423934937,0.03522925823926926,0,0.7510773539543152,0,0.007864867337048054,0.009046219289302826,0.2780488133430481,0.5794898271560669,4.248129367828369,0.11727726459503174,0.012030016630887985,0.2766039967536926,0,0.33435070514678955,2.4298627376556396,0,0.37858518958091736,0.15787246823310852,0.40566179156303406,0.02205190807580948,1.573803186416626,0.12264887988567352,0.004571790806949139,0,0.015819121152162552,1.0197728872299194,0.10165086388587952,0,0.3364711403846741,0.3802306056022644,1.2229253053665161,0.019003763794898987,0.03490157425403595,0.21972617506980896,1.1198253631591797,0.7397270798683167,0.15005306899547577,0.581440806388855,0,2.781047821044922,1.4518029689788818,0.020587794482707977,0,0.14920561015605927,0.2701643407344818,0,0.0713057890534401,0,0.4174758791923523,0.11625036597251892,2.59436297416687,0.08536317199468613,0.4691755473613739,0.08845490962266922,1.1372994184494019,0.3742079436779022,0.6470959186553955,0,0,1.098287582397461,0,0.8920754194259644,0.42163699865341187,2.7046897411346436,0.16670837998390198,2.038048267364502,0,0.6445856690406799,0.6323000192642212,0.9409970641136169,1.0074771642684937,0,0.01511179655790329,0.10040318220853806,0.017828354611992836,0,0.49707573652267456,0.9570357799530029,0.015401029959321022,0.3715525269508362,1.5269358158111572,1.8005456924438477,0,0,0.30761057138442993,1.5653733015060425,2.576565742492676,1.402572751045227,0.022061005234718323,0,0.6456044912338257,0.0014190941583365202,2.0006279945373535,2.0169034004211426,0.03688289225101471,0.09803159534931183,0.06778004765510559,2.568574905395508,0.05574508756399155,2.148076057434082,0.018031666055321693,0.02347925305366516,0.2327713519334793,0.26640310883522034,0.0742516741156578,0.05664844810962677,0.2818722724914551,0.4906679689884186,1.3438384532928467,0.7540791034698486,0.016456779092550278,1.318056583404541,1.4055068492889404,0.12294875085353851,1.3261842727661133,0,0.44248083233833313,0.3510275185108185,0.2189520299434662,0.24377547204494476,0.3230511546134949,0.5476951003074646,0.6513909101486206,0.03720322623848915,0,0.04002341628074646,0.012018310837447643,0.4600760042667389,0.9681999087333679,0.3092137575149536,0.05287371948361397,0.5404731035232544,0.1809511035680771,0.006623526103794575,1.3955219984054565,0,0.07368981093168259,0,0.0006084247725084424,4.179327964782715,0.3936305046081543,0.30195531249046326,1.0199823379516602,0.0538814514875412,0.6472264528274536,0.04029875993728638,0.9949495196342468,0.13604208827018738,0,0.008368288166821003,0.12251690775156021,0.06560369580984116,1.6573724746704102,0.033939410001039505,0,0.013939308002591133,0.5553008317947388,0,0.32231491804122925,0,0,0.23046760261058807,0.1201733946800232,0.5272508859634399,0.7827355265617371,0,0.6280779242515564,0.5801113843917847,0.0820818617939949,0,0,0,0.0016594468615949154,0.7085515260696411,0.003362976713106036,1.1729158163070679,0.005004019010812044,0.057517241686582565,0.747178852558136,0.05993719398975372,0.13451209664344788,0.001079603098332882,0,0.1199658066034317,0.43811777234077454,0.9197277426719666,0,2.8885891437530518,0,0.43620073795318604,2.6561827659606934,0.3554556667804718,0.016249917447566986,0.11465777456760406,0.11014103144407272,0.09689519554376602,0.04452292621135712,0,0.1058969721198082,0.7702429890632629,0.048688456416130066,0,0.003933461382985115,0.8309693336486816,0.01045431662350893,0,1.2456297874450684,1.0801246166229248,0,0.8973202705383301,0.24670083820819855,0,1.9300589561462402,0.10099945217370987,0,0.4978584349155426,0.08020931482315063,0.9410679936408997,0.13826555013656616,0.0917012095451355,0.98432457447052,0.28002315759658813,0.12736016511917114,0.5521991848945618,0,0.2908723056316376,0,0.5105841755867004,0.09807547926902771,0.008427527733147144,0.33355751633644104,1.2940256595611572,0,1.3413604497909546,0.028459610417485237,0.30915188789367676,1.2036528587341309,1.420822024345398,1.4484680891036987,0,0,1.418705701828003,0.011477437801659107,0.7930632829666138,1.8065378665924072,0.8792106509208679,0.153939351439476,0.006259334273636341,2.4267282485961914,0.11593492329120636,2.583717107772827,0.024347538128495216,0.17039115726947784,0.27121585607528687,0.003210318274796009,0,0,0.4053456485271454,1.2872569561004639,0.024802247062325478,0.1671007126569748,0,0,0.059397511184215546,0,0.044890813529491425,0.11850220710039139,0.03353843837976456,0.5449919104576111,0.2952888309955597,0.00877018366008997,0.4446742534637451,0.29798632860183716,0.06952615827322006,0.1602936089038849,0.4703626036643982,0,0.8726412653923035,0.04496585577726364,0.11582717299461365,0.3263343572616577,0.3112211525440216,0.022876495495438576,0,0,0.06988769769668579,0,0.4020370543003082,0.010307292453944683,1.2193419933319092,1.8128986358642578,0.009565569460391998,0.19986172020435333,0,1.146970272064209,0.06316570192575455,0.002907178830355406,0,0.036008529365062714,0.007576918229460716,0.007231617346405983,0.4219478666782379,0.06614860892295837,0.12090323865413666,0.02177339605987072,0.0003337300440762192,0.1746980845928192,0.49126917123794556,0.0740622729063034,0,1.9029988050460815,0.2078106701374054,0.07259254157543182,0.18397529423236847,0.04317028820514679,0.1754089891910553,1.3983886241912842,0,0.36215341091156006,0.02062792144715786,0.13003157079219818,2.006324052810669,0.036502186208963394,0.17063084244728088,0.604491114616394,0.07518193125724792,0.03757372125983238,0.0012312592007219791,0.011242881417274475,0.7932848930358887,0,0.002627280307933688,0,0.4587593376636505,0.21680788695812225,2.0326480865478516,0.2319052517414093,0.0011145691387355328,0.9972376823425293,0.012288253754377365,0.19448819756507874,0.6333905458450317,0.022252647206187248,0,0.4969193637371063,0,0.39362919330596924,1.5676542520523071,0.07057268917560577,0,0.6618308424949646,0.06484326720237732,0.18452179431915283,2.723472833633423,0.4795037508010864,0,0.12079586088657379,0.0445404089987278,1.8122358322143555,2.5211310386657715,0,0,0.0027711051516234875,0.015673479065299034,0,0.3166121542453766,0,0.00910277385264635,0,2.1200554370880127,0.027283474802970886,1.1266177892684937,0.0742793083190918,0.02523544430732727,0,0.036664269864559174,0.39869603514671326,0.4322892427444458,0.056619804352521896,0.23608839511871338,0.08811037987470627,0.005003469530493021,0.8526546955108643,1.754402995109558,0,0.3765377998352051,0.030562536790966988,0.015358883887529373,0.04226904362440109,0.07259262353181839,0.2558019459247589,0.08992637693881989,0.06981683522462845,0.4713892638683319,0.24684491753578186,0.27449363470077515,1.784597396850586,0.0747772678732872,0.5280758738517761,0.03228776901960373,0.09933608025312424,0.5837335586547852,0,1.180098295211792,0.02882395312190056,0.6670230031013489,0,0.1499725580215454,2.7417449951171875,2.412186861038208,2.1519131660461426,0.643784761428833,0.00678354874253273,0.23738735914230347,0.025738906115293503,0.03014402650296688,0.06121345981955528,0.3928438425064087,0.10053819417953491,0,0,0,0.4348612427711487,0,0.03785433992743492,0.09186188131570816,0.722637951374054,0,0.04888802021741867,0.0337865985929966,0.005969008430838585,1.0895514488220215,0.10646957159042358,0.10794416815042496,0.018922846764326096,0.17386291921138763,0.007019955199211836,0.5829455256462097,1.2620210647583008,0.1584477573633194,0.6108972430229187,0.05043930560350418,0.6095582842826843,0.00296381046064198,0,0.13649699091911316,1.816811203956604,0.056052908301353455,0.11657537519931793,1.1709492206573486,0.005175468977540731,0.008719678036868572,0.024262739345431328,0.3747059106826782,0.0027445019222795963,0.39756307005882263,0.008518938906490803,1.2271676063537598,0.0022850986570119858,1.4107640981674194,1.7246904373168945,0.006888390984386206,0.5296123027801514,0.303111732006073,1.9329038858413696,0,0.21855595707893372,0.005460890009999275,0.7438464760780334,0.26557886600494385,0.17882086336612701,0,1.1022484302520752,0.15047487616539001,0.24025268852710724,2.2764816284179688,0.32808396220207214,0,1.6138383150100708,2.224378824234009,0.009286109358072281,0.9859064817428589,0.024777719751000404,0.1353207379579544,0,0.018243907019495964,0,0.3044794499874115,1.8799396753311157,0.012059851549565792,0.8522819876670837,0.03288005664944649,0.0550752654671669,0.6981840133666992,0.8184219598770142,0,0.6575195789337158,2.185123920440674,0.1653057038784027,0.910661518573761,0.012065651826560497,1.0824379920959473,0.1670386642217636,0.04593624547123909,0.23113924264907837,0,0.19546356797218323,0,0,0,0.099651999771595,0.04035564512014389,2.013578414916992,0.7294257879257202,0.4987267553806305,0.2649403512477875,0.1693708449602127,1.0899467468261719,2.750375509262085,0.664583683013916,0.3402057886123657,1.246921181678772,0.06493443250656128,0.30357885360717773,1.0984076261520386,2.0449330806732178,1.4526989459991455,0.3151107430458069,0.047113534063100815,0.0786118283867836,0.14303848147392273,0.27133843302726746,0.09891460090875626,0.6422019600868225,0.060196515172719955,0.6575499773025513,0,0.2618404030799866,0,0,0,0.01027465146034956,0.009796719066798687,0.6029770970344543,0.0861709862947464,0.007837451063096523,0.0007469118572771549,0.005549275316298008,0.19908544421195984,0,0.009475771337747574,0.0862695723772049,0.6012083292007446,0.03224821388721466,0,0.0053727165795862675,0,0,1.0325074195861816,0.08264538645744324,0.03149053826928139,1.7726337909698486,0.052071474492549896,2.5718793869018555,0.020112739875912666,0,2.362694025039673,0.3818151652812958,0.2870296537876129,1.5366311073303223,0,0.4403110146522522,1.7868789434432983,0.12887580692768097,0,0.3765227794647217,0.0023533788044005632,0.03447335213422775,1.496151089668274,0.010454973205924034,0.009689302183687687,0,0,1.6136417388916016,0.7490181922912598,0.02495570108294487,0.1855040043592453,0.3890720307826996,0.12753430008888245,0.10647192597389221,0.13930150866508484,0.015088110230863094,0.08755017071962357,0.00976712629199028,0.521295964717865,0.04568958654999733,0,2.0510318279266357,1.8141065835952759,0,0.45215070247650146,0,0.049551524221897125,0.019509458914399147,0.15259990096092224,0.7724827527999878,0.04226149246096611,0.7241954207420349,0.020446505397558212,0,0.019140100106596947,0.5687148571014404,0.7506809830665588,0.612156331539154,0.014541455544531345,0.00010397726146038622,0,0.02661573328077793,0.1970013976097107,0,0.10832709074020386,0.3299710750579834,0.20441053807735443,0.7895929217338562,0.00790618360042572,0.149397075176239,0.36447909474372864,0.14945417642593384,1.5801655054092407,0.24224205315113068,0.23706796765327454,0.031273216009140015,0,0.05455980449914932,0.38691315054893494,0.031555596739053726,0.7709360718727112,1.7158324718475342,0,1.1651513576507568,0.042156245559453964,0,3.2612669467926025,0.9187410473823547,1.186348557472229,1.5526597499847412,0.5062317252159119,0,0.06164189800620079,2.1179285049438477,1.1670498847961426,0.4632648825645447,0.2922515571117401,0,0.2961197793483734,1.4979842901229858,0.06161951646208763,0.07580395042896271,0.33979159593582153,0.03396286442875862,2.322361469268799,0.7508832216262817,0.001897541806101799,0,0.1487007439136505,1.0522352457046509,0.01372828334569931,0.12307344377040863]"

	req, err = makeMultipartRequestMilvus("https://dfraud-flask-sb.vishwamcorp.com/v1/dfraud/liveness", encodings, "partition_name", "5e98599f51929c1ed0b77f7f34b7585f")
	//fmt.Println("req: ", req.Body, err)

	if err != nil {
		errMsg := "unable to create multipart form request"
		log.Println(errMsg)
	}

	resp, err := http.DefaultClient.Do(req)
	if err != nil {
		log.Println(err)
	}
	responseData, err := ioutil.ReadAll(resp.Body)
	//fmt.Println(resp, err)
	defer resp.Body.Close()

	myJson := string(responseData)
	myJson = strings.ReplaceAll(myJson, " ", "")
	myJson = strings.ReplaceAll(myJson, "\n", "")
	//fmt.Println("myJson: ", myJson)
	jsonConfig := []byte(myJson)

	var retrieveDkycOut chMilvusOut
	err = json.Unmarshal(jsonConfig, &retrieveDkycOut)
	fmt.Println("final", retrieveDkycOut)
	if err != nil {
		return retrieveDkycOut, nil
	}

	return retrieveDkycOut, nil
}

func main() {
	resp, err := CheckMilvusEncodings()
	fmt.Println(resp, err)
	fmt.Println(resp.XcallID)
	fmt.Println(resp.MatchCount)
	fmt.Println(resp.MatchResults)
	fmt.Println(resp.TopFiveResults)
}
